# 策略管理测试用例文档

## 测试目标
验证策略管理系统的功能完整性、稳定性和正确性。

## 测试环境准备

### 前置条件
- 系统已安装Python 3.7+
- 所有依赖已安装（`pip install -r requirements.txt`）
- 项目代码完整无编译错误

### 测试数据准备
- 确保网络连接正常（用于获取行情数据）
- 准备测试用历史数据文件（可选）

## 测试用例清单

### 1. 策略管理界面测试

#### TC-01: 策略管理窗口打开测试
**测试目的**：验证策略管理窗口能正常打开
**前置条件**：主程序已启动
**测试步骤**：
1. 启动主程序：`python ui/main.py`
2. 点击主界面右上角的"策略管理"按钮
3. 观察窗口是否成功打开

**预期结果**：
- [ ] 策略管理窗口成功打开
- [ ] 窗口标题显示"策略管理"
- [ ] 窗口包含策略列表和详情区域

**测试数据**：无

#### TC-02: 策略列表加载测试
**测试目的**：验证策略列表能正常加载和显示
**前置条件**：策略管理窗口已打开
**测试步骤**：
1. 打开策略管理窗口
2. 观察策略列表是否显示预设模板
3. 检查表头是否正确（策略ID、策略名称、策略类型、状态、交易品种、总盈利）

**预期结果**：
- [ ] 显示4个预设策略模板
- [ ] 表头信息完整正确
- [ ] 状态列有颜色区分（绿色=运行中，红色=已停止）

### 2. 策略创建测试

#### TC-03: 创建新策略测试
**测试目的**：验证能成功创建新策略
**前置条件**：策略管理窗口已打开
**测试步骤**：
1. 点击"添加策略"按钮
2. 填写策略信息：
   - 策略名称：测试策略1
   - 策略类型：CTA策略
   - 交易品种：rb2410,IF2406
   - 策略参数：使用默认值
3. 点击"确定"按钮

**预期结果**：
- [ ] 弹出成功提示："策略已添加: [策略ID]"
- [ ] 策略列表自动刷新，显示新创建的策略
- [ ] 策略状态为"stopped"

**测试数据**：
```json
{
  "trade_volume": 1,
  "stop_loss": 10,
  "take_profit": 20
}
```

#### TC-04: 创建策略参数验证测试
**测试目的**：验证策略参数验证功能
**前置条件**：策略管理窗口已打开
**测试步骤**：
1. 点击"添加策略"按钮
2. 填写策略信息，但策略参数填写无效JSON
3. 点击"确定"按钮

**预期结果**：
- [ ] 策略仍能被创建
- [ ] 使用空参数或默认参数

**测试数据**：
```json
无效JSON: { invalid json }
```

### 3. 策略启动/停止测试

#### TC-05: 启动策略测试
**测试目的**：验证策略能正常启动
**前置条件**：已创建测试策略，状态为停止
**测试步骤**：
1. 在策略列表中选择测试策略
2. 点击"启动策略"按钮
3. 观察状态变化

**预期结果**：
- [ ] 弹出成功提示："策略已启动: [策略ID]"
- [ ] 策略状态变为"running"
- [ ] 状态列背景变为绿色

#### TC-06: 停止策略测试
**测试目的**：验证策略能正常停止
**前置条件**：测试策略状态为运行中
**测试步骤**：
1. 在策略列表中选择运行中的策略
2. 点击"停止策略"按钮
3. 观察状态变化

**预期结果**：
- [ ] 弹出成功提示："策略已停止: [策略ID]"
- [ ] 策略状态变为"stopped"
- [ ] 状态列背景变为红色

### 4. 策略详情查看测试

#### TC-07: 策略详情显示测试
**测试目的**：验证策略详情能正确显示
**前置条件**：策略列表中至少有一个策略
**测试步骤**：
1. 在策略列表中点击任意策略
2. 观察右侧详情区域

**预期结果**：
- [ ] 右侧显示策略详细信息
- [ ] 包含策略ID、名称、类型、状态、创建时间、交易品种
- [ ] 显示策略参数（JSON格式）
- [ ] 显示策略绩效指标

### 5. 策略移除测试

#### TC-08: 移除策略测试
**测试目的**：验证策略能被正确移除
**前置条件**：策略列表中至少有一个策略
**测试步骤**：
1. 在策略列表中选择要移除的策略
2. 点击"移除策略"按钮
3. 在确认对话框中点击"是"
4. 观察策略列表变化

**预期结果**：
- [ ] 弹出确认对话框
- [ ] 成功移除后弹出提示："策略已移除: [策略ID]"
- [ ] 策略从列表中消失

#### TC-09: 移除运行中策略测试
**测试目的**：验证运行中的策略能被正确移除
**前置条件**：策略状态为运行中
**测试步骤**：
1. 启动一个策略
2. 选择该运行中的策略
3. 点击"移除策略"按钮
4. 确认移除

**预期结果**：
- [ ] 策略先被停止，然后被移除
- [ ] 无错误提示

### 6. 回测功能测试

#### TC-10: 策略回测测试
**测试目的**：验证策略回测功能
**前置条件**：已创建测试策略
**测试步骤**：
1. 在策略列表中选择测试策略
2. 点击"回测策略"按钮
3. 设置回测时间段：
   - 开始日期：30天前
   - 结束日期：今天
4. 点击"确定"开始回测

**预期结果**：
- [ ] 弹出回测设置对话框
- [ ] 回测完成后显示结果
- [ ] 显示总交易次数、总盈利、胜率

#### TC-11: 回测参数验证测试
**测试目的**：验证回测参数验证
**前置条件**：已创建测试策略
**测试步骤**：
1. 选择策略进行回测
2. 设置开始日期晚于结束日期
3. 点击"确定"

**预期结果**：
- [ ] 显示错误提示或自动调整日期范围

### 7. 策略模板测试

#### TC-12: 策略模板加载测试
**测试目的**：验证预设策略模板正确加载
**前置条件**：策略管理窗口已打开
**测试步骤**：
1. 观察策略列表中的预设策略
2. 检查每个策略的参数配置

**预期结果**：
- [ ] 显示4个预设策略模板
- [ ] 每个策略都有完整参数配置
- [ ] 策略描述信息正确

#### TC-13: 策略模板参数验证
**测试目的**：验证策略模板参数正确性
**测试步骤**：
1. 选择一个预设策略
2. 查看策略参数
3. 与模板定义对比

**预期结果**：
- [ ] 参数与预设模板完全一致
- [ ] 参数格式正确（JSON格式）

### 8. 性能测试

#### TC-14: 大量策略测试
**测试目的**：验证系统能处理大量策略
**前置条件**：策略管理窗口已打开
**测试步骤**：
1. 连续创建10个不同策略
2. 观察系统响应
3. 尝试启动多个策略

**预期结果**：
- [ ] 系统响应正常，无明显卡顿
- [ ] 所有策略都能正常创建和启动

#### TC-15: 刷新性能测试
**测试目的**：验证刷新功能性能
**前置条件**：已创建多个策略
**测试步骤**：
1. 多次点击"刷新"按钮
2. 观察刷新响应时间

**预期结果**：
- [ ] 刷新响应时间<1秒
- [ ] 数据正确加载

### 9. 异常处理测试

#### TC-16: 空策略列表测试
**测试目的**：验证空策略列表处理
**前置步骤**：删除所有策略
**测试步骤**：
1. 打开策略管理窗口
2. 观察空列表显示
3. 尝试选择空策略

**预期结果**：
- [ ] 界面显示正常，无错误
- [ ] 按钮状态正确（某些按钮应禁用）

#### TC-17: 重复策略名称测试
**测试目的**：验证重复策略名称处理
**前置条件**：已存在同名策略
**测试步骤**：
1. 创建同名策略
2. 观察系统处理

**预期结果**：
- [ ] 允许创建同名策略（通过ID区分）
- [ ] 每个策略有唯一ID

## 测试执行记录表

| 测试用例 | 执行日期 | 执行人 | 结果 | 备注 |
|----------|----------|--------|------|------|
| TC-01 | | | ☐/☐ | |
| TC-02 | | | ☐/☐ | |
| TC-03 | | | ☐/☐ | |
| TC-04 | | | ☐/☐ | |
| TC-05 | | | ☐/☐ | |
| TC-06 | | | ☐/☐ | |
| TC-07 | | | ☐/☐ | |
| TC-08 | | | ☐/☐ | |
| TC-09 | | | ☐/☐ | |
| TC-10 | | | ☐/☐ | |
| TC-11 | | | ☐/☐ | |
| TC-12 | | | ☐/☐ | |
| TC-13 | | | ☐/☐ | |
| TC-14 | | | ☐/☐ | |
| TC-15 | | | ☐/☐ | |
| TC-16 | | | ☐/☐ | |
| TC-17 | | | ☐/☐ | |

## 测试注意事项

1. **环境隔离**：测试时建议使用模拟账户
2. **数据备份**：测试前备份配置文件
3. **日志查看**：如遇到问题，查看系统日志获取详情
4. **逐步测试**：建议按顺序逐步执行测试用例
5. **异常记录**：详细记录任何异常情况

## 测试完成标准

- [ ] 所有功能测试用例通过
- [ ] 界面显示正常，无布局错误
- [ ] 策略创建、启动、停止、移除功能正常
- [ ] 回测功能能正常执行
- [ ] 异常处理机制工作正常
- [ ] 性能满足要求（响应时间<1秒）

## 测试后清理

1. 删除测试创建的所有策略
2. 恢复原始配置文件
3. 清理测试日志
4. 备份测试数据（如需）